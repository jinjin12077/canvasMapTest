<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>canvas를 통해 맵 그리기</title>

    <style>
        #canvas{border: 1px solid #000;width: 750px;height: 500px;position: relative;}
        .dot{background: red;width: 10px;height: 10px;position: absolute;}
        .line{display: inline-block;border-top: 3px solid #000;position: absolute;}
    </style>

    
</head>
<body>
    <div id="map">
        <!-- <canvas id="canvas" width="750" height="500"></canvas> -->
        <div id="canvas"></div>
    </div>

    <script>
        function drawDot(){
            var ctx;
            var canvas = document.getElementById("canvas");
            if (canvas.getContext) {
                ctx = canvas.getContext("2d");
            }

            canvas.addEventListener('click', function(e){
                if (canvas.getContext) {
                    var l = this.offsetLeft;
                    var t = this.offsetTop;
                    var x = e.pageX - l;
                    var y = e.pageY - t;
                    var w = 15;
                    var h = 15;

                    ctx.fillStyle = "rgb(255, 187, 0)";
                    ctx.fillRect(x, y, w, h);
                }
            });

            // if(){}
        }

        function drawLine(){
            console.log('drawLine');
        }

        // drawDot();
        // drawLine();


        // 점 그리는 함수
        function drawDot2(){
            var canvas = document.getElementById("canvas");
            var index = 0;

            canvas.addEventListener('click', function(e){
                var x = e.pageX;
                var y = e.pageY;
                var newDIV = document.createElement("div");

                drawLine(x, y, index);

                newDIV.setAttribute("class","dot");
                newDIV.setAttribute("attr","dot-"+index);
                newDIV.style.left = (x-10)+'px';
                newDIV.style.top = (y-10)+'px';
                canvas.appendChild(newDIV);

                index++;
            });

            
        }

        // 선 그리는 함수
        function drawLine(x, y, index){
            if(canvas.childElementCount > 0){       // canvas 안에 하위요소가 있는지 확인
                var dots = document.querySelectorAll('#canvas .dot');
                var before_x = dots[index-1].offsetLeft;
                var before_y = dots[index-1].offsetTop;
                var dot_width = Math.sqrt( Math.pow((x - before_x), 2) + Math.pow((y - before_y), 2) );
                var newLine = document.createElement("div");


                newLine.setAttribute("class", "line");
                newLine.setAttribute("attr", "line-"+index);
                newLine.style.width = dot_width+'px';
                newLine.style.left = before_x+'px';
                newLine.style.top = before_y+'px';
                
                canvas.appendChild(newLine);
            }
            
        }

        drawDot2();
    </script>
</body>
</html>